---
// File: src/pages/index.astro
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";

import HeroSection from "../components/sections/Hero.astro";
import WhyNowSection from "../components/sections/WhyNow.astro";
import BotGuideSection from "../components/sections/BotGuide.astro";
import EnglishTrackSection from "../components/sections/EnglishTrack.astro";
import CoursesSection from "../components/sections/Courses.astro";
import AdvantagesSection from "../components/sections/Advantages.astro";
import HowItWorksSection from "../components/sections/HowItWorks.astro";
import TestimonialsSection from "../components/sections/Testimonials.astro";
import FinalCtaSection from "../components/sections/FinalCta.astro";
import FaqSection from "../components/sections/Faq.astro";

const blockComponents = {
  hero: HeroSection,
  whyNow: WhyNowSection,
  botGuide: BotGuideSection,
  englishTrack: EnglishTrackSection,
  courses: CoursesSection,
  advantages: AdvantagesSection,
  howItWorks: HowItWorksSection,
  testimonials: TestimonialsSection,
  finalCta: FinalCtaSection,
  faq: FaqSection,
};

const allBlocks = await getCollection("landing-blocks");
const sortedBlocks = allBlocks.sort((a, b) => a.data.order - b.data.order);
---

<Layout title="Accept School - Твой IT-старт!">
  {
    sortedBlocks.map((blockEntry) => {
      const Component = blockComponents[blockEntry.data.block_type];
      if (!Component) {
        return (
          <p>
            Component for block type "{blockEntry.data.block_type}" not found.
          </p>
        );
      }
      return <Component entry={blockEntry} />;
    })
  }
</Layout>
